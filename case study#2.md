# Pizza Runner Data Analysis Project

<span style="font-size: 48px;">üçï Pizza Runner Logo</span>



## Introduction

Welcome to the Pizza Runner Data Analysis project! In this project, we will explore and analyze data related to Pizza Runner, a pizza delivery startup founded by Danny. Danny's vision is to revolutionize pizza delivery by combining 80s retro styling with the convenience of on-demand delivery.

## Available Data

We have access to several tables in the `pizza_runner` database schema. These tables include:

- `runners`: Information about the registration date of each runner.
- `customer_orders`: Records of customer pizza orders, including pizza details, exclusions, extras, and order times.
- `runner_orders`: Data about orders assigned to runners, including pickup times, distance, duration, and cancellations.
- `pizza_names`: Details about the available pizza types.
- `pizza_recipes`: Lists of toppings for each pizza type.
- `pizza_toppings`: A mapping of topping names to topping IDs.

## Case Study Questions

This project is divided into several areas of focus, and we will address various questions within each area:

### A. Pizza Metrics

- How many pizzas were ordered?
- How many unique customer orders were made?
- How many successful orders were delivered by each runner?
- How many of each type of pizza was delivered?
- How many Vegetarian and Meatlovers were ordered by each customer?
- What was the maximum number of pizzas delivered in a single order?
- For each customer, how many delivered pizzas had at least 1 change and how many had no changes?
- How many pizzas were delivered that had both exclusions and extras?
- What was the total volume of pizzas ordered for each hour of the day?
- What was the volume of orders for each day of the week?

### B. Runner and Customer Experience

- How many runners signed up for each 1-week period?
- What was the average time in minutes it took for each runner to arrive at the Pizza Runner HQ to pick up the order?
- Is there any relationship between the number of pizzas and how long the order takes to prepare?
- What was the average distance traveled for each customer?
- What was the difference between the longest and shortest delivery times for all orders?
- What was the average speed for each runner for each delivery, and do you notice any trend for these values?
- What is the successful delivery percentage for each runner?

### C. Ingredient Optimization

- What are the standard ingredients for each pizza?
- What was the most commonly added extra?
- What was the most common exclusion?
- Generate an order item for each record in the `customer_orders` table in a specific format.
- Generate an alphabetically ordered comma-separated ingredient list for each pizza order.

### D. Pricing and Ratings

- Calculate the revenue generated by Pizza Runner.
- Calculate the revenue with an additional charge for pizza extras.
- Design a new table for customer ratings and insert sample data.
- Join all necessary information for successful deliveries.

### E. Bonus Questions

- Discuss the impact of adding a new pizza type to the existing data design.
- Provide an INSERT statement for adding a new Supreme pizza to the menu.

Feel free to explore the interactive SQL instance provided to work on these questions. We hope you enjoy analyzing the data and helping Pizza Runner optimize its operations!

## Getting Started

To get started with this project, you can:

1. Clone this repository.
2. Set up a database environment with the provided schema.
3. Use your preferred SQL client to execute queries and explore the data.
4. Answer the case study questions using SQL queries.

Happy data analyzing, and may your insights help Pizza Runner thrive!

## Case Study Questions
#### Data Cleaning for `runner_orders` Table and Creating Temporary Table

```sql
-- Clean `runner_orders` data and create a temporary table
/* Clean runner_orders */
SELECT * 
FROM [Pizza Runner].[dbo].[runner_orders];

-- Replace NULL, NAN, and empty spaces in the cancellation column and create a temporary table
/* replace NULL, NAN, AND SPACE BY NO_cancellation AND CREATE TABLE*/
SELECT order_id, runner_id, pickup_time, distance, duration, 
  CASE
    WHEN cancellation IS NULL OR cancellation = '' OR cancellation = 'NAN' THEN 'no_cancellation'
    ELSE cancellation
  END AS cancellation
INTO temporar_runner_orders
FROM [Pizza Runner].[dbo].[runner_orders];

-- View the data in the temporary table
SELECT *
FROM temporar_runner_orders;

-- Edit pickup_time (Additional data cleaning steps go here)
/* EDIT pickup_time */
UPDATE temporar_runner_orders
SET pickup_time = DATEADD(year, 1, pickup_time)
WHERE DATEPART(YEAR, pickup_time) = '2020';

SELECT  *
FROM temporar_runner_orders;

-- Convert pickup_time from string to datetime
update temporar_runner_orders
SET pickup_time = convert(datetime, pickup_time, 20);

-- Additional steps for cleaning distance and duration columns go here

-- Remove 'km' and 'minutes' from distance and duration
/*  remove 'km' and 'minutes' from distance and duration*/ 
UPDATE temporar_runner_orders
SET duration = CASE
    WHEN duration LIKE '%[^0-9.]%' THEN SUBSTRING(duration, 0, PATINDEX('%[^0-9.]%', duration))
    ELSE duration
  END
FROM temporar_runner_orders;

UPDATE temporar_runner_orders
SET distance = CASE
    WHEN distance LIKE '%[^0-9.]%' THEN SUBSTRING(distance, 0, PATINDEX('%[^0-9.]%', distance))
    ELSE distance
  END
FROM temporar_runner_orders;

-- View the cleaned data in the temporary table
SELECT *
FROM temporar_runner_orders;
```
 ### A. Pizza Metrics

#### Answers to Pizza Metrics Questions

**1. How many pizzas were ordered?**
```sql
SELECT COUNT(order_id) pizza_numbers
FROM [Pizza Runner].[dbo].customer_orders;
```
| pizza_numbers | 
|---------------| 
| 14            |   
## 2. How many unique customer orders were made?
```sql
SELECT COUNT(DISTINCT order_id) uniq_customer_order
FROM [Pizza Runner].[dbo].customer_orders;
```
| uniq_customer_order | 
|---------------------| 
| 10                  | 


### Question 3: How many successful orders were delivered by each runner?

```sql
SELECT runner_id, COUNT(*) AS successful_order
FROM temporar_runner_orders
WHERE cancellation = 'no_cancellation'
GROUP BY runner_id;
```
result3:
| runner_id  | successful_order  | 
|----------|----------|
|      1   | 4        | 
| 2        |3         |
| 3        | 1        |


### Question 4: How many of each type of pizza was delivered?
```sql
SELECT pizza_name, COUNT(*) nu_pizza_type
FROM temporar_runner_orders t
JOIN [Pizza Runner].[dbo].customer_orders c ON t.order_id = c.order_id
JOIN [Pizza Runner].dbo.pizza_names P ON C.pizza_id = P.pizza_id
WHERE cancellation = 'no_cancellation'
GROUP BY pizza_name;
```
| pizza_name | nu_pizza_type  | 
|----------|----------|
|Meat Lovers  |9       | 
| Vegetarian      |3         |


### Question 5: How many Vegetarian and Meatlovers were ordered by each customer?
 ```sql
SELECT customer_id, pizza_name, COUNT(pizza_name) total_type
FROM temporar_runner_orders t
join [Pizza Runner].[dbo].customer_orders c
on t.order_id =c.order_id
JOIN [Pizza Runner].dbo.pizza_names P
ON C.pizza_id = P.pizza_id
GROUP BY customer_id, pizza_name;
```
| customer_id | pizza_name  | total_type |
|-------------|-------------|------------|
| 101         | Meat Lovers | 2          |
| 101         | Vegetarian  | 1          |
| 102         | Meat Lovers | 2          |
| 102         | Vegetarian  | 1          |
| 103         | Meat Lovers | 3          |
| 103         | Vegetarian  | 1          |
| 104         | Meat Lovers | 3          |
| 105         | Vegetarian  | 1          |


### Question 6: What was the maximum number of pizzas delivered in a single order?
```sql
SELECT TOP 1 c.order_id, COUNT(*) AS max_n_pizzas_delivered
FROM temporar_runner_orders t
JOIN [Pizza Runner].[dbo].customer_orders c
ON t.order_id = c.order_id
WHERE cancellation = 'no_cancellation'
GROUP BY c.order_id
ORDER BY max_n_pizzas_delivered DESC;
```
result 6:
| order_id | max_n_pizzas_delivered |
|----------|-------------------------|
| 4        | 3                       |

### Question 7: For each customer, how many delivered pizzas had at least 1 change and how many had no changes?
```sql
 with ch as (SELECT customer_id, count(*) pizza_change
 FROM  temporar_runner_orders t
join [Pizza Runner].[dbo].customer_orders c
on t.order_id =c.order_id
where exclusions <> 'n_ex' or extras <> 'n_xt'  and cancellation = 'no_cancellation'
GROUP BY customer_id),
n_ch as (SELECT customer_id, count(*) n_change
 FROM  temporar_runner_orders t
join [Pizza Runner].[dbo].customer_orders c
on t.order_id =c.order_id
where exclusions = 'n_ex' AND extras = 'n_xt'
GROUP BY customer_id)
SELECT  distinct c.customer_id, COALESCE(pizza_change, 0) AS pizza_change, COALESCE(n_change, 0) AS n_change
FROM [Pizza Runner].[dbo].customer_orders c
  full outer join n_ch n
on c.customer_id = n.customer_id
 full outer join ch 
on c.customer_id = ch.customer_id ;
```
result 7 : 
| customer_id | pizza_change | n_change |
|------------|--------------|----------|
| 101        | 0            | 3        |
| 102        | 0            | 3        |
| 103        | 4            | 0        |
| 104        | 2            | 1        |
| 105        | 1            | 0        |

### Question 8: How many pizzas were delivered that had both exclusions and extras?
```sql
SELECT COUNT(c.order_id) AS both_excl_ext
FROM temporar_runner_orders t
JOIN [Pizza Runner].[dbo].customer_orders c
ON t.order_id = c.order_id
WHERE exclusions <> 'n_ex' AND extras <> 'n_xt' AND cancellation = 'no_cancellation';
```
result 8:
| both_excl_ext |
|------------|
| 1      |
### Question 9: What was the total volume of pizzas ordered for each hour of the day?
```sql
 select DATEPART(HOUR, order_time) hours_day, COUNT(order_id) nb_per_hour
 from  [Pizza Runner].[dbo].customer_orders
 GROUP BY DATEPART(HOUR, order_time);

```
result 9:
| hours_day | nb_per_hour |
|-----------|-------------|
| 11        | 1           |
| 13        | 3           |
| 18        | 3           |
| 19        | 1           |
| 21        | 3           |
| 23        | 3           |

### Question 10: What was the volume of orders for each day of the week?

```sql
 select DATENAME(WEEKDAY, order_time ) day_ofweek , COUNT(order_id) nb_per_weekday
 from  [Pizza Runner].[dbo].customer_orders
 GROUP BY DATENAME(WEEKDAY, order_time );
```
result 10:
| day_ofweek | nb_per_weekday |
|------------|----------------|
| Friday     | 5              |
| Monday     | 5              |
| Saturday   | 3              |
| Sunday     | 1              |



